"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[921],{9005:(e,r,t)=>{t.r(r),t.d(r,{default:()=>U});var n=t(5861),a=t(9439),o=t(4687),i=t.n(o),s=t(7004),d=t(7294),c=t(967),u=(0,c.K)((function(e){var r;return null===(r=e.editablePostCard)||void 0===r?void 0:r.post})),l=(0,a.Z)(u,2),p=(l[0],l[1],(0,c.K)((function(e){var r,t;return null!==(r=null===(t=e.editablePostCard)||void 0===t?void 0:t.form)&&void 0!==r?r:{}}))),f=(0,a.Z)(p,2),v=f[0],b=f[1],h=(0,c.K)((function(e){var r;return null===(r=e.editablePostCard)||void 0===r?void 0:r.isLoading})),m=(0,a.Z)(h,2),y=m[0],g=(m[1],(0,c.K)((function(e){var r;return null===(r=e.editablePostCard)||void 0===r?void 0:r.error}))),j=(0,a.Z)(g,2),C=(j[0],j[1],(0,c.K)((function(e){var r;return null===(r=e.editablePostCard)||void 0===r?void 0:r.readonly}))),P=(0,a.Z)(C,2),x=P[0],O=(P[1],t(4268)),Z=t(7747),w=(0,O.hg)("profile/updateProfileData",function(){var e=(0,n.Z)(i().mark((function e(r,t){var n,a,o,s,d,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.rejectWithValue,a=t.getState,o=t.dispatch,s=b(a()),d=new FormData,s.author&&s.date&&(d.append("author",s.author),d.append("date",s.date),d.append("message",null!==(c=s.message)&&void 0!==c?c:""),d.append("file",r)),s.id){e.next=6;break}return e.abrupt("return",n("error"));case 6:return e.prev=6,e.next=9,o((0,Z.G)({postId:s.id,form:d})).unwrap();case 9:if(u=e.sent){e.next=12;break}throw new Error;case 12:return e.abrupt("return",u);case 15:return e.prev=15,e.t0=e.catch(6),console.log(e.t0),e.abrupt("return",n("error"));case 19:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(r,t){return e.apply(this,arguments)}}()),k=t(4942);function E(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function D(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?E(Object(t),!0).forEach((function(r){(0,k.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var K=(0,O.oM)({name:"editablePostCard",initialState:{},reducers:{initPostCard:function(e,r){e.post=r.payload,e.form=D({},r.payload)},setReadonly:function(e,r){e.readonly=r.payload},cancelEdit:function(e){e.readonly=!0,e.form=e.post},updatePost:function(e,r){e.form=D(D({},e.form),r.payload)}},extraReducers:function(e){e.addCase(w.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(w.fulfilled,(function(e){e.isLoading=!1})).addCase(w.rejected,(function(e,r){e.isLoading=!1,e.error=r.payload}))}}),L=K.actions,F=K.reducer,S=t(1230),T=t(9650),I=t(1577),N=t(5893),A=(0,d.memo)((function(e){var r=e.onCancelEdit,t=y();return(0,N.jsx)(S.Z,{justify:"end",children:(0,N.jsxs)(T.Z,{size:8,children:[(0,N.jsx)(s.Z.Item,{children:(0,N.jsx)(I.ZP,{htmlType:"reset",onClick:r,disabled:t,danger:!0,children:"Отменить"})}),(0,N.jsx)(s.Z.Item,{children:(0,N.jsx)(I.ZP,{htmlType:"submit",type:"primary",loading:t,children:"Сохранить"})})]})})}));var M=t(4795),R=t(2640),W=t(3007),z=t(1233),B=t(5401),G=t(9970),Q={editablePostCard:F};const U=(0,d.memo)((function(e){var r=e.className,t=e.post,o=e.onCancelEdit,c=e.onSave,u=(0,B.T)(),l=y(),p=x(),f=v(),b=(0,M.T)({}),h=b.files,m=b.onChangeFiles,g=s.Z.useForm(),j=(0,a.Z)(g,1)[0];(0,G.Q)((function(){u(L.initPostCard(t))}));var C=(0,d.useCallback)((function(e){u(L.updatePost({message:e.target.value}))}),[u]),P=(0,d.useCallback)((0,n.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(w(h[0]));case 2:null==c||c();case 3:case"end":return e.stop()}}),e)}))),[u,h,c]);return(0,N.jsx)(z.W,{reducers:Q,removeAfterUnmount:!0,children:(0,N.jsxs)(s.Z,{form:j,onFinish:P,className:(0,W.A)("B76K0gN7",{},[r]),children:[(0,N.jsx)(R.y,{post:f,readonly:p,isLoading:!1,onChangeMessage:C}),(0,N.jsx)(M.Y,{files:h,readonly:p,isLoading:l,onChangeFiles:m}),(0,N.jsx)(A,{onCancelEdit:o})]})})}))}}]);